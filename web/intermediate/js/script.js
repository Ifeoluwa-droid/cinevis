var xField="Budget",yField="Worldwide Gross",xDomain,yDomain,xScale,yScale,xAxis,yAxis,xAxisPanel,yAxisPanel,xLegend,yLegend,data,svg,numberFormat=d3.format(",.0f"),locate=function(a,b){var c,d,e;b==="x"?(c=a[xField],d=xScale,e=xDomain):(c=a[yField],d=yScale,e=yDomain);return $.isNumeric(c)?d(c):e[0]},setDomain=function(a){return[d3.min(data,function(b){return $.isNumeric(b[a])?+b[a]:0}),d3.max(data,function(b){return $.isNumeric(b[a])?+b[a]:0})]};
d3.json("/data/moviedata.json",function(a){data=a;var a=$("#vis").width(),b=$("#vis").height(),c=[0,a-65],d=[b-65,0];xDomain=setDomain(xField,data);yDomain=setDomain(yField,data);xScale=d3.scale.linear().domain(xDomain).range(c);yScale=d3.scale.linear().domain(yDomain).range(d);xAxis=d3.svg.axis().scale(xScale).orient("bottom").ticks(5).tickSize(-(b-65),0,0).tickFormat(numberFormat);yAxis=d3.svg.axis().orient("left").scale(yScale).ticks(5).tickSize(-(a-65),0,0).tickFormat(numberFormat);svg=d3.select("#vis").append("svg").attr("width",
a).attr("height",b).append("g").attr("transform","translate(55,10)");xAxisPanel=svg.append("g").attr("class","x axis").attr("id","xTicks").attr("transform","translate(0,"+(b-65)+")").call(xAxis);xLegend=svg.append("text").attr("id","xLabel").attr("x",a/2).attr("y",b-65/3).attr("text-anchor","middle").attr("class","axisTitle").text(xField);yAxisPanel=svg.append("g").attr("class","y axis").attr("id","yTicks").attr("transform","translate(0,0)").call(yAxis);yLegend=svg.append("text").attr("id","yLabel").attr("x",
b/2).attr("y",65/3).attr("text-anchor","end").attr("class","axisTitle").attr("transform","translate(-65,"+b*0.85+")rotate(-90)").text(yField);svg.selectAll("circle").data(data).enter().append("circle").attr("class","point").attr("cx",function(a){return locate(a,"x")}).attr("cy",function(a){return locate(a,"y")}).attr("r",5).on("mouseover",mouseover).on("mouseout",mouseout)});
function mouseover(a){$("#details").css("display","inline");$("#detail-film-value").html(a.Film);$("#detail-year-value").html(a.Year);$("#detail-profitability-value").html(a.Profitability);$("#detail-budget-value").html(a.Budget);$("#detail-theatres-value").html(a["Number of Theatres in US Opening Weekend"]);$("#detail-worldwide-value").html(a["Worldwide Gross"]);$("#detail-audience-value").html(a["Audience  score %"]);$("#detail-genre-value").html(a.Genre);$("#detail-openingweekend-value").html(a["Opening Weekend"]);
$("#detail-domestic-value").html(a["Domestic Gross"]);$("#detail-rotten-value").html(a["Rotten Tomatoes %"]);$("#detail-story-value").html(a.Story);$("#detail-avgcinema-value").html(a["Box Office Average per US Cinema (Opening Weekend)"]);$("#detail-foreign-value").html(a["Foreign Gross"]);$("#detail-oscar-value").html(a.Oscar);$("#detail-studio-value").html(a["Lead Studio"]);d3.select(this).style("stroke-width",2.5).style("stroke","orange")}
function mouseout(){$("#details").css("display","none");d3.select(this).style("stroke-width",null).style("stroke",null)}
$(function(){$("#xaxis").val(xField);$("#yaxis").val(yField);$("#xaxis").change(function(){xField=$("#xaxis").val();xDomain=setDomain(xField);xScale.domain(xDomain);xAxis.scale(xScale);svg.select("#xTicks").call(xAxis);svg.select("#xLabel").text(xField);redraw()});$("#yaxis").change(function(){yField=$("#yaxis").val();yDomain=setDomain(yField);yScale.domain(yDomain);yAxis.scale(yScale);svg.select("#yTicks").call(yAxis);svg.select("#yLabel").text(yField);redraw()})});
function redraw(){svg.selectAll("circle").data(data).transition().duration(1E3).attr("cx",function(a){return locate(a,"x")}).attr("cy",function(a){return locate(a,"y")})};
